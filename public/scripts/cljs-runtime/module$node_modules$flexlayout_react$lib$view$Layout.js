shadow$provide.module$node_modules$flexlayout_react$lib$view$Layout=function(global,require,module,exports){var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,b$jscomp$0)};return function(d,b){function __(){this.constructor=d}extendStatics(d,
b);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});exports.Layout=void 0;var React=require("module$node_modules$react$index"),DockLocation_1=require("module$node_modules$flexlayout_react$lib$DockLocation"),DragDrop_1=require("module$node_modules$flexlayout_react$lib$DragDrop"),Actions_1=require("module$node_modules$flexlayout_react$lib$model$Actions"),SplitterNode_1=require("module$node_modules$flexlayout_react$lib$model$SplitterNode"),
TabNode_1=require("module$node_modules$flexlayout_react$lib$model$TabNode"),TabSetNode_1=require("module$node_modules$flexlayout_react$lib$model$TabSetNode"),Rect_1=require("module$node_modules$flexlayout_react$lib$Rect"),Types_1=require("module$node_modules$flexlayout_react$lib$Types"),BorderTabSet_1=require("module$node_modules$flexlayout_react$lib$view$BorderTabSet"),Splitter_1=require("module$node_modules$flexlayout_react$lib$view$Splitter"),Tab_1=require("module$node_modules$flexlayout_react$lib$view$Tab"),
TabSet_1=require("module$node_modules$flexlayout_react$lib$view$TabSet"),FloatingWindow_1=require("module$node_modules$flexlayout_react$lib$view$FloatingWindow"),FloatingWindowTab_1=require("module$node_modules$flexlayout_react$lib$view$FloatingWindowTab"),TabFloating_1=require("module$node_modules$flexlayout_react$lib$view$TabFloating");global="undefined"!==typeof window&&(window.document.documentMode||/Edge\//.test(window.navigator.userAgent));var defaultSupportsPopout="undefined"!==typeof window&&
window.matchMedia&&window.matchMedia("(hover: hover) and (pointer: fine)").matches&&!global;global=function(_super){function Layout(props){var _this=_super.call(this,props)||this;_this.firstMove=!1;_this.dragDivText="";_this.onModelChange=function(){_this.forceUpdate();if(_this.props.onModelChange)_this.props.onModelChange(_this.props.model)};_this.updateRect=function(){var domRect=_this.getDomRect();domRect=new Rect_1.default(0,0,domRect.width,domRect.height);domRect.equals(_this.state.rect)||0===
domRect.width||0===domRect.height||_this.setState({rect:domRect})};_this.updateLayoutMetrics=function(){if(_this.findHeaderBarSizeRef.current){var headerBarSize=_this.findHeaderBarSizeRef.current.getBoundingClientRect().height;headerBarSize!==_this.state.calculatedHeaderBarSize&&_this.setState({calculatedHeaderBarSize:headerBarSize})}_this.findTabBarSizeRef.current&&(headerBarSize=_this.findTabBarSizeRef.current.getBoundingClientRect().height,headerBarSize!==_this.state.calculatedTabBarSize&&_this.setState({calculatedTabBarSize:headerBarSize}));
_this.findBorderBarSizeRef.current&&(headerBarSize=_this.findBorderBarSizeRef.current.getBoundingClientRect().height,headerBarSize!==_this.state.calculatedBorderBarSize&&_this.setState({calculatedBorderBarSize:headerBarSize}))};_this.getClassName=function(defaultClassName){return void 0===_this.props.classNameMapper?defaultClassName:_this.props.classNameMapper(defaultClassName)};_this.onCloseWindow=function(id){_this.doAction(Actions_1.default.unFloatTab(id));try{_this.props.model.getNodeById(id)._setWindow(void 0)}catch(e){}};
_this.onSetWindow=function(id,window){_this.props.model.getNodeById(id)._setWindow(window)};_this.onCancelAdd=function(){_this.selfRef.current.removeChild(_this.dragDiv);_this.dragDiv=void 0;null!=_this.fnNewNodeDropped&&(_this.fnNewNodeDropped(),_this.fnNewNodeDropped=void 0);DragDrop_1.default.instance.hideGlass();_this.newTabJson=void 0};_this.onCancelDrag=function(wasDragging){if(wasDragging){wasDragging=_this.selfRef.current;try{wasDragging.removeChild(_this.outlineDiv)}catch(e){}try{wasDragging.removeChild(_this.dragDiv)}catch(e){}_this.dragDiv=
void 0;_this.hideEdges(wasDragging);null!=_this.fnNewNodeDropped&&(_this.fnNewNodeDropped(),_this.fnNewNodeDropped=void 0);DragDrop_1.default.instance.hideGlass();_this.newTabJson=void 0}};_this.onDragDivMouseDown=function(event){event.preventDefault();_this.dragStart(event,_this.dragDivText,TabNode_1.default._fromJson(_this.newTabJson,_this.props.model,!1),!0,void 0,void 0)};_this.dragStart=function(event,dragDivText,node,allowDrag,onClick,onDoubleClick){void 0===_this.props.model.getMaximizedTabset()&&
allowDrag?(_this.dragNode=node,_this.dragDivText=dragDivText,DragDrop_1.default.instance.startDrag(event,_this.onDragStart,_this.onDragMove,_this.onDragEnd,_this.onCancelDrag,onClick,onDoubleClick,_this.currentDocument,_this.selfRef.current)):DragDrop_1.default.instance.startDrag(event,void 0,void 0,void 0,void 0,onClick,onDoubleClick,_this.currentDocument,_this.selfRef.current)};_this.onDragStart=function(){_this.dropInfo=void 0;var rootdiv=_this.selfRef.current;_this.outlineDiv=_this.currentDocument.createElement("div");
_this.outlineDiv.className=_this.getClassName(Types_1.CLASSES.FLEXLAYOUT__OUTLINE_RECT);rootdiv.appendChild(_this.outlineDiv);null==_this.dragDiv&&(_this.dragDiv=_this.currentDocument.createElement("div"),_this.dragDiv.className=_this.getClassName(Types_1.CLASSES.FLEXLAYOUT__DRAG_RECT),_this.dragDiv.innerHTML=_this.dragDivText,rootdiv.appendChild(_this.dragDiv));_this.showEdges(rootdiv);void 0!==_this.dragNode&&_this.dragNode instanceof TabNode_1.default&&void 0!==_this.dragNode.getTabRect()&&_this.dragNode.getTabRect().positionElement(_this.outlineDiv);
return _this.firstMove=!0};_this.onDragMove=function(event){if(!1===_this.firstMove){var speed=_this.props.model._getAttribute("tabDragSpeed");_this.outlineDiv.style.transition="top "+speed+"s, left "+speed+"s, width "+speed+"s, height "+speed+"s"}_this.firstMove=!1;var clientRect=_this.selfRef.current.getBoundingClientRect();speed=event.clientX-clientRect.left;event=event.clientY-clientRect.top;_this.dragDiv.style.left=speed-_this.dragDiv.getBoundingClientRect().width/2+"px";_this.dragDiv.style.top=
event+5+"px";if(event=_this.props.model._findDropTargetNode(_this.dragNode,speed,event))_this.dropInfo=event,_this.outlineDiv.className=_this.getClassName(event.className),event.rect.positionElement(_this.outlineDiv)};_this.onDragEnd=function(event){var rootdiv=_this.selfRef.current;rootdiv.removeChild(_this.outlineDiv);rootdiv.removeChild(_this.dragDiv);_this.dragDiv=void 0;_this.hideEdges(rootdiv);DragDrop_1.default.instance.hideGlass();_this.dropInfo&&(void 0!==_this.newTabJson?(rootdiv=_this.doAction(Actions_1.default.addNode(_this.newTabJson,
_this.dropInfo.node.getId(),_this.dropInfo.location,_this.dropInfo.index)),null!=_this.fnNewNodeDropped&&(_this.fnNewNodeDropped(rootdiv,event),_this.fnNewNodeDropped=void 0),_this.newTabJson=void 0):void 0!==_this.dragNode&&_this.doAction(Actions_1.default.moveNode(_this.dragNode.getId(),_this.dropInfo.node.getId(),_this.dropInfo.location,_this.dropInfo.index)))};_this.props.model._setChangeListener(_this.onModelChange);_this.tabIds=[];_this.selfRef=React.createRef();_this.findHeaderBarSizeRef=React.createRef();
_this.findTabBarSizeRef=React.createRef();_this.findBorderBarSizeRef=React.createRef();_this.supportsPopout=void 0!==props.supportsPopout?props.supportsPopout:defaultSupportsPopout;_this.popoutURL=props.popoutURL?props.popoutURL:"popout.html";_this.icons=props.closeIcon?Object.assign({close:props.closeIcon},props.icons):props.icons;_this.firstRender=!0;_this.state={rect:new Rect_1.default(0,0,0,0),calculatedHeaderBarSize:25,calculatedTabBarSize:26,calculatedBorderBarSize:30};_this.onDragEnter=_this.onDragEnter.bind(_this);
return _this}__extends(Layout,_super);Layout.prototype.styleFont=function(style){this.props.font&&(this.props.font.size&&(style.fontSize=this.props.font.size),this.props.font.family&&(style.fontFamily=this.props.font.family),this.props.font.style&&(style.fontStyle=this.props.font.style),this.props.font.weight&&(style.fontWeight=this.props.font.weight));return style};Layout.prototype.doAction=function(action){if(void 0!==this.props.onAction){if(action=this.props.onAction(action),void 0!==action)return this.props.model.doAction(action)}else return this.props.model.doAction(action)};
Layout.prototype.componentDidMount=function(){this.updateRect();this.updateLayoutMetrics();this.currentDocument=this.selfRef.current.ownerDocument;this.currentWindow=this.currentDocument.defaultView;this.currentWindow.addEventListener("resize",this.updateRect)};Layout.prototype.componentDidUpdate=function(){this.updateRect();this.updateLayoutMetrics();this.props.model!==this.previousModel&&(void 0!==this.previousModel&&this.previousModel._setChangeListener(void 0),this.props.model._setChangeListener(this.onModelChange),
this.previousModel=this.props.model)};Layout.prototype.getCurrentDocument=function(){return this.currentDocument};Layout.prototype.getDomRect=function(){return this.selfRef.current.getBoundingClientRect()};Layout.prototype.getRootDiv=function(){return this.selfRef.current};Layout.prototype.isSupportsPopout=function(){return this.supportsPopout};Layout.prototype.getPopoutURL=function(){return this.popoutURL};Layout.prototype.componentWillUnmount=function(){this.currentWindow.removeEventListener("resize",
this.updateRect)};Layout.prototype.render=function(){var _this=this;if(this.firstRender)return this.firstRender=!1,React.createElement("div",{ref:this.selfRef,className:this.getClassName(Types_1.CLASSES.FLEXLAYOUT__LAYOUT)},this.metricsElements());this.props.model._setPointerFine(window&&window.matchMedia&&window.matchMedia("(pointer: fine)").matches);var borderComponents=[],tabSetComponents=[],floatingWindows=[],tabComponents={},splitterComponents=[];this.centerRect=this.props.model._layout(this.state.rect,
{headerBarSize:this.state.calculatedHeaderBarSize,tabBarSize:this.state.calculatedTabBarSize,borderBarSize:this.state.calculatedBorderBarSize});this.renderBorder(this.props.model.getBorderSet(),borderComponents,tabComponents,floatingWindows,splitterComponents);this.renderChildren(this.props.model.getRoot(),tabSetComponents,tabComponents,floatingWindows,splitterComponents);var nextTopIds=[],nextTopIdsMap={};this.tabIds.forEach(function(t){tabComponents[t]&&(nextTopIds.push(t),nextTopIdsMap[t]=t)});
this.tabIds=nextTopIds;Object.keys(tabComponents).forEach(function(t){nextTopIdsMap[t]||_this.tabIds.push(t)});return React.createElement("div",{ref:this.selfRef,className:this.getClassName(Types_1.CLASSES.FLEXLAYOUT__LAYOUT),onDragEnter:this.props.onExternalDrag?this.onDragEnter:void 0},tabSetComponents,this.tabIds.map(function(t){return tabComponents[t]}),borderComponents,splitterComponents,floatingWindows,this.metricsElements())};Layout.prototype.metricsElements=function(){var fontStyle=this.styleFont({visibility:"hidden"});
return React.createElement(React.Fragment,null,React.createElement("div",{key:"findHeaderBarSize",ref:this.findHeaderBarSizeRef,style:fontStyle,className:this.getClassName(Types_1.CLASSES.FLEXLAYOUT__TABSET_HEADER_SIZER)},"FindHeaderBarSize"),React.createElement("div",{key:"findTabBarSize",ref:this.findTabBarSizeRef,style:fontStyle,className:this.getClassName(Types_1.CLASSES.FLEXLAYOUT__TABSET_SIZER)},"FindTabBarSize"),React.createElement("div",{key:"findBorderBarSize",ref:this.findBorderBarSizeRef,
style:fontStyle,className:this.getClassName(Types_1.CLASSES.FLEXLAYOUT__BORDER_SIZER)},"FindBorderBarSize"))};Layout.prototype.renderBorder=function(borderSet,borderComponents,tabComponents,floatingWindows,splitterComponents){var _i=0;for(borderSet=borderSet.getBorders();_i<borderSet.length;_i++){var border=borderSet[_i];if(border.isShowing()){borderComponents.push(React.createElement(BorderTabSet_1.BorderTabSet,{key:"border_"+border.getLocation().getName(),border,layout:this,iconFactory:this.props.iconFactory,
titleFactory:this.props.titleFactory,icons:this.icons}));for(var i=0,_b=0,drawChildren_1=border._getDrawChildren();_b<drawChildren_1.length;_b++){var child=drawChildren_1[_b];if(child instanceof SplitterNode_1.default)splitterComponents.push(React.createElement(Splitter_1.Splitter,{key:child.getId(),layout:this,node:child}));else if(child instanceof TabNode_1.default)if(this.supportsPopout&&child.isFloating()){var rect=this._getScreenRect(child);floatingWindows.push(React.createElement(FloatingWindow_1.FloatingWindow,
{key:child.getId(),url:this.popoutURL,rect,title:child.getName(),id:child.getId(),onSetWindow:this.onSetWindow,onCloseWindow:this.onCloseWindow},React.createElement(FloatingWindowTab_1.FloatingWindowTab,{layout:this,node:child,factory:this.props.factory})));tabComponents[child.getId()]=React.createElement(TabFloating_1.TabFloating,{key:child.getId(),layout:this,node:child,selected:i===border.getSelected()})}else tabComponents[child.getId()]=React.createElement(Tab_1.Tab,{key:child.getId(),layout:this,
node:child,selected:i===border.getSelected(),factory:this.props.factory});i++}}}};Layout.prototype.renderChildren=function(node,tabSetComponents,tabComponents,floatingWindows,splitterComponents){var _i=0;for(node=node._getDrawChildren();_i<node.length;_i++){var child=node[_i];if(child instanceof SplitterNode_1.default)splitterComponents.push(React.createElement(Splitter_1.Splitter,{key:child.getId(),layout:this,node:child}));else if(child instanceof TabSetNode_1.default)tabSetComponents.push(React.createElement(TabSet_1.TabSet,
{key:child.getId(),layout:this,node:child,iconFactory:this.props.iconFactory,titleFactory:this.props.titleFactory,icons:this.icons})),this.renderChildren(child,tabSetComponents,tabComponents,floatingWindows,splitterComponents);else if(child instanceof TabNode_1.default){var selectedTab=child.getParent().getChildren()[child.getParent().getSelected()];void 0===selectedTab&&console.warn("undefined selectedTab should not happen");if(this.supportsPopout&&child.isFloating()){var rect=this._getScreenRect(child);
floatingWindows.push(React.createElement(FloatingWindow_1.FloatingWindow,{key:child.getId(),url:this.popoutURL,rect,title:child.getName(),id:child.getId(),onSetWindow:this.onSetWindow,onCloseWindow:this.onCloseWindow},React.createElement(FloatingWindowTab_1.FloatingWindowTab,{layout:this,node:child,factory:this.props.factory})));tabComponents[child.getId()]=React.createElement(TabFloating_1.TabFloating,{key:child.getId(),layout:this,node:child,selected:child===selectedTab})}else tabComponents[child.getId()]=
React.createElement(Tab_1.Tab,{key:child.getId(),layout:this,node:child,selected:child===selectedTab,factory:this.props.factory})}else this.renderChildren(child,tabSetComponents,tabComponents,floatingWindows,splitterComponents)}};Layout.prototype._getScreenRect=function(node){node=node.getRect().clone();var bodyRect=this.selfRef.current.getBoundingClientRect(),navHeight=Math.min(80,this.currentWindow.outerHeight-this.currentWindow.innerHeight);node.x=node.x+bodyRect.x+this.currentWindow.screenX+Math.min(80,
this.currentWindow.outerWidth-this.currentWindow.innerWidth);node.y=node.y+bodyRect.y+this.currentWindow.screenY+navHeight;return node};Layout.prototype.addTabToTabSet=function(tabsetId,json){void 0!==this.props.model.getNodeById(tabsetId)&&this.doAction(Actions_1.default.addNode(json,tabsetId,DockLocation_1.default.CENTER,-1))};Layout.prototype.addTabToActiveTabSet=function(json){var tabsetNode=this.props.model.getActiveTabset();void 0!==tabsetNode&&this.doAction(Actions_1.default.addNode(json,tabsetNode.getId(),
DockLocation_1.default.CENTER,-1))};Layout.prototype.addTabWithDragAndDrop=function(dragText,json,onDrop){this.fnNewNodeDropped=onDrop;this.newTabJson=json;this.dragStart(void 0,dragText,TabNode_1.default._fromJson(json,this.props.model,!1),!0,void 0,void 0)};Layout.prototype.addTabWithDragAndDropIndirect=function(dragText,json,onDrop){this.fnNewNodeDropped=onDrop;this.newTabJson=json;DragDrop_1.default.instance.addGlass(this.onCancelAdd);this.dragDivText=dragText;this.dragDiv=this.currentDocument.createElement("div");
this.dragDiv.className=this.getClassName("flexlayout__drag_rect");this.dragDiv.innerHTML=this.dragDivText;this.dragDiv.addEventListener("mousedown",this.onDragDivMouseDown);this.dragDiv.addEventListener("touchstart",this.onDragDivMouseDown);dragText=new Rect_1.default(10,10,150,50);dragText.centerInRect(this.state.rect);this.dragDiv.style.left=dragText.x+"px";this.dragDiv.style.top=dragText.y+"px";this.selfRef.current.appendChild(this.dragDiv)};Layout.prototype.onDragEnter=function(event){if(!DragDrop_1.default.instance.isDragging()){var drag=
this.props.onExternalDrag(event);drag&&(this.fnNewNodeDropped=drag.onDrop,this.newTabJson=drag.json,this.dragStart(event,drag.dragText,TabNode_1.default._fromJson(drag.json,this.props.model,!1),!0,void 0,void 0))}};Layout.prototype.showEdges=function(rootdiv){if(this.props.model.isEnableEdgeDock()){var domRect=rootdiv.getBoundingClientRect(),r=this.centerRect;this.edgeTopDiv=this.currentDocument.createElement("div");this.edgeTopDiv.className=this.getClassName(Types_1.CLASSES.FLEXLAYOUT__EDGE_RECT);
this.edgeTopDiv.style.top=r.y+"px";this.edgeTopDiv.style.left=r.x+(r.width-100)/2+"px";this.edgeTopDiv.style.width="100px";this.edgeTopDiv.style.height="10px";this.edgeTopDiv.style.borderBottomLeftRadius="50px";this.edgeTopDiv.style.borderBottomRightRadius="50px";this.edgeLeftDiv=this.currentDocument.createElement("div");this.edgeLeftDiv.className=this.getClassName(Types_1.CLASSES.FLEXLAYOUT__EDGE_RECT);this.edgeLeftDiv.style.top=r.y+(r.height-100)/2+"px";this.edgeLeftDiv.style.left=r.x+"px";this.edgeLeftDiv.style.width=
"10px";this.edgeLeftDiv.style.height="100px";this.edgeLeftDiv.style.borderTopRightRadius="50px";this.edgeLeftDiv.style.borderBottomRightRadius="50px";this.edgeBottomDiv=this.currentDocument.createElement("div");this.edgeBottomDiv.className=this.getClassName(Types_1.CLASSES.FLEXLAYOUT__EDGE_RECT);this.edgeBottomDiv.style.bottom=domRect.height-r.getBottom()+"px";this.edgeBottomDiv.style.left=r.x+(r.width-100)/2+"px";this.edgeBottomDiv.style.width="100px";this.edgeBottomDiv.style.height="10px";this.edgeBottomDiv.style.borderTopLeftRadius=
"50px";this.edgeBottomDiv.style.borderTopRightRadius="50px";this.edgeRightDiv=this.currentDocument.createElement("div");this.edgeRightDiv.className=this.getClassName(Types_1.CLASSES.FLEXLAYOUT__EDGE_RECT);this.edgeRightDiv.style.top=r.y+(r.height-100)/2+"px";this.edgeRightDiv.style.right=domRect.width-r.getRight()+"px";this.edgeRightDiv.style.width="10px";this.edgeRightDiv.style.height="100px";this.edgeRightDiv.style.borderTopLeftRadius="50px";this.edgeRightDiv.style.borderBottomLeftRadius="50px";
rootdiv.appendChild(this.edgeTopDiv);rootdiv.appendChild(this.edgeLeftDiv);rootdiv.appendChild(this.edgeBottomDiv);rootdiv.appendChild(this.edgeRightDiv)}};Layout.prototype.hideEdges=function(rootdiv){if(this.props.model.isEnableEdgeDock())try{rootdiv.removeChild(this.edgeTopDiv),rootdiv.removeChild(this.edgeLeftDiv),rootdiv.removeChild(this.edgeBottomDiv),rootdiv.removeChild(this.edgeRightDiv)}catch(e){}};Layout.prototype.maximize=function(tabsetNode){this.doAction(Actions_1.default.maximizeToggle(tabsetNode.getId()))};
Layout.prototype.customizeTab=function(tabNode,renderValues){if(this.props.onRenderTab)this.props.onRenderTab(tabNode,renderValues)};Layout.prototype.customizeTabSet=function(tabSetNode,renderValues){if(this.props.onRenderTabSet)this.props.onRenderTabSet(tabSetNode,renderValues)};Layout.prototype.i18nName=function(id,param){var message;this.props.i18nMapper&&(message=this.props.i18nMapper(id,param));void 0===message&&(message=id+(void 0===param?"":param));return message};return Layout}(React.Component);
exports.Layout=global;exports.default=global}
//# sourceMappingURL=module$node_modules$flexlayout_react$lib$view$Layout.js.map
