shadow$provide.module$node_modules$golden_layout$dist$cjs$ts$controls$drag_proxy=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.DragProxy=void 0;const internal_error_1=require("module$node_modules$golden_layout$dist$cjs$ts$errors$internal_error"),stack_1=require("module$node_modules$golden_layout$dist$cjs$ts$items$stack");global=require("module$node_modules$golden_layout$dist$cjs$ts$utils$event_emitter");const jquery_legacy_1=require("module$node_modules$golden_layout$dist$cjs$ts$utils$jquery_legacy"),
types_1=require("module$node_modules$golden_layout$dist$cjs$ts$utils$types"),utils_1=require("module$node_modules$golden_layout$dist$cjs$ts$utils$utils");class DragProxy extends global.EventEmitter{constructor(x,y,_dragListener,_layoutManager,_componentItem,_originalParent){super();this._dragListener=_dragListener;this._layoutManager=_layoutManager;this._componentItem=_componentItem;this._originalParent=_originalParent;this._lastValidArea=this._area=null;this._dragListener.on("drag",(offsetX,offsetY,
event)=>this.onDrag(offsetX,offsetY,event));this._dragListener.on("dragStop",()=>this.onDrop());this._element=document.createElement("div");this._element.classList.add("lm_dragProxy");_dragListener=document.createElement("div");_dragListener.classList.add("lm_header");_layoutManager=document.createElement("div");_layoutManager.classList.add("lm_tabs");_componentItem=document.createElement("div");_componentItem.classList.add("lm_tab");_originalParent=document.createElement("span");_originalParent.classList.add("lm_title");
_componentItem.appendChild(_originalParent);_layoutManager.appendChild(_componentItem);_dragListener.appendChild(_layoutManager);this._proxyContainerElement=document.createElement("div");this._proxyContainerElement.classList.add("lm_content");this._element.appendChild(_dragListener);this._element.appendChild(this._proxyContainerElement);this._originalParent instanceof stack_1.Stack&&this._originalParent.headerShow&&(this._sided=this._originalParent.headerLeftRightSided,this._element.classList.add("lm_"+
this._originalParent.headerSide),0<=[types_1.Side.right,types_1.Side.bottom].indexOf(this._originalParent.headerSide)&&this._proxyContainerElement.insertAdjacentElement("afterend",_dragListener));this._element.style.left=utils_1.numberToPixels(x);this._element.style.top=utils_1.numberToPixels(y);_componentItem.setAttribute("title",utils_1.stripTags(this._componentItem.title));_originalParent.insertAdjacentText("afterbegin",this._componentItem.title);this._proxyContainerElement.appendChild(this._componentItem.element);
if(null===this._componentItem.parent)throw new internal_error_1.UnexpectedNullError("DPC10097");{(this._componentItemFocused=this._componentItem.focused)&&this._componentItem.blur();this._componentItem.parent.removeChild(this._componentItem,!0);this._layoutManager.calculateItemAreas();this.setDimensions();document.body.appendChild(this._element);_dragListener=jquery_legacy_1.getJQueryOffset(this._layoutManager.container);this._minX=_dragListener.left;this._minY=_dragListener.top;const {width:containerWidth,
height:containerHeight}=utils_1.getElementWidthAndHeight(this._layoutManager.container);this._maxX=containerWidth+this._minX;this._maxY=containerHeight+this._minY;const {width:elementWidth,height:elementHeight}=utils_1.getElementWidthAndHeight(this._element);this._width=elementWidth;this._height=elementHeight;this._layoutManager.layoutConfig.settings.constrainDragToContainer&&(x<=this._minX?x=Math.ceil(this._minX+1):x>=this._maxX&&(x=Math.floor(this._maxX-1)),y<=this._minY?y=Math.ceil(this._minY+
1):y>=this._maxY&&(y=Math.floor(this._maxY-1)));this.setDropPosition(x,y)}}get element(){return this._element}onDrag(offsetX,offsetY,event){offsetX=event.pageX;event=event.pageY;this._layoutManager.layoutConfig.settings.constrainDragToContainer?offsetX>this._minX&&offsetX<this._maxX&&event>this._minY&&event<this._maxY&&this.setDropPosition(offsetX,event):this.setDropPosition(offsetX,event)}setDropPosition(x,y){this._element.style.left=utils_1.numberToPixels(x);this._element.style.top=utils_1.numberToPixels(y);
this._area=this._layoutManager.getArea(x,y);null!==this._area&&(this._lastValidArea=this._area,this._area.contentItem.highlightDropZone(x,y,this._area))}onDrop(){const dropTargetIndicator=this._layoutManager.dropTargetIndicator;if(null===dropTargetIndicator)throw new internal_error_1.UnexpectedNullError("DPOD30011");dropTargetIndicator.hide();let droppedComponentItem;null!==this._area?(droppedComponentItem=this._componentItem,this._area.contentItem.onDrop(droppedComponentItem,this._area)):null!==
this._lastValidArea?(droppedComponentItem=this._componentItem,this._lastValidArea.contentItem.onDrop(droppedComponentItem,this._lastValidArea)):this._originalParent?(droppedComponentItem=this._componentItem,this._originalParent.addChild(droppedComponentItem)):this._componentItem.destroy();this._element.remove();this._layoutManager.emit("itemDropped",this._componentItem);this._componentItemFocused&&void 0!==droppedComponentItem&&droppedComponentItem.focus()}setDimensions(){var dimensions=this._layoutManager.layoutConfig.dimensions;
if(void 0===dimensions)throw Error("DragProxy.setDimensions: dimensions undefined");{let width=dimensions.dragProxyWidth,height=dimensions.dragProxyHeight;if(void 0===width||void 0===height)throw Error("DragProxy.setDimensions: width and/or height undefined");dimensions=!1===this._layoutManager.layoutConfig.header.show?0:dimensions.headerHeight;this._element.style.width=utils_1.numberToPixels(width);this._element.style.height=utils_1.numberToPixels(height);width-=this._sided?dimensions:0;height-=
this._sided?0:dimensions;this._proxyContainerElement.style.width=utils_1.numberToPixels(width);this._proxyContainerElement.style.height=utils_1.numberToPixels(height);this._componentItem.setDragSize(width,height);this._componentItem.show()}}}exports.DragProxy=DragProxy}
//# sourceMappingURL=module$node_modules$golden_layout$dist$cjs$ts$controls$drag_proxy.js.map
