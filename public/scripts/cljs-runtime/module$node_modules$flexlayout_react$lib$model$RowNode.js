shadow$provide.module$node_modules$flexlayout_react$lib$model$RowNode=function(global,require,module,exports){var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,b$jscomp$0)};return function(d,b){function __(){this.constructor=d}extendStatics(d,
b);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});var AttributeDefinitions_1=require("module$node_modules$flexlayout_react$lib$AttributeDefinitions"),DockLocation_1=require("module$node_modules$flexlayout_react$lib$DockLocation"),DropInfo_1=require("module$node_modules$flexlayout_react$lib$DropInfo"),Orientation_1=require("module$node_modules$flexlayout_react$lib$Orientation"),Rect_1=require("module$node_modules$flexlayout_react$lib$Rect"),
BorderNode_1=require("module$node_modules$flexlayout_react$lib$model$BorderNode");global=require("module$node_modules$flexlayout_react$lib$model$Node");var SplitterNode_1=require("module$node_modules$flexlayout_react$lib$model$SplitterNode"),TabSetNode_1=require("module$node_modules$flexlayout_react$lib$model$TabSetNode");require=function(_super){function RowNode(model,json){var _this=_super.call(this,model)||this;_this._dirty=!0;_this._drawChildren=[];_this.minHeight=0;_this.minWidth=0;RowNode._attributeDefinitions.fromJson(json,
_this._attributes);model._addNode(_this);return _this}__extends(RowNode,_super);RowNode._fromJson=function(json,model){var newLayoutNode=new RowNode(model,json);if(null!=json.children){var _i=0;for(json=json.children;_i<json.length;_i++){var jsonChild=json[_i];jsonChild=jsonChild.type===TabSetNode_1.default.TYPE?TabSetNode_1.default._fromJson(jsonChild,model):RowNode._fromJson(jsonChild,model);newLayoutNode._addChild(jsonChild)}}return newLayoutNode};RowNode._createAttributeDefinitions=function(){var attributeDefinitions=
new AttributeDefinitions_1.default;attributeDefinitions.add("type",RowNode.TYPE,!0);attributeDefinitions.add("id",void 0);attributeDefinitions.add("weight",100);attributeDefinitions.add("width",void 0);attributeDefinitions.add("height",void 0);return attributeDefinitions};RowNode.prototype.getWeight=function(){return this._attributes.weight};RowNode.prototype.getWidth=function(){return this._getAttributeAsNumberOrUndefined("width")};RowNode.prototype.getHeight=function(){return this._getAttributeAsNumberOrUndefined("height")};
RowNode.prototype._setWeight=function(weight){this._attributes.weight=weight};RowNode.prototype._layout=function(rect,metrics){_super.prototype._layout.call(this,rect,metrics);var pixelSize=this._rect._getSize(this.getOrientation()),totalWeight=0,fixedPixels=0,prefPixels=0,totalPrefWeight=0;rect=this._getDrawChildren();for(var _i=0;_i<rect.length;_i++){var child=rect[_i],prefSize=child._getPrefSize(this.getOrientation());child._isFixed()?void 0!==prefSize&&(fixedPixels+=prefSize):void 0===prefSize?
totalWeight+=child.getWeight():(prefPixels+=prefSize,totalPrefWeight+=child.getWeight())}_i=!1;prefPixels=pixelSize-fixedPixels-prefPixels;0>prefPixels&&(prefPixels=pixelSize-fixedPixels,_i=!0,totalWeight+=totalPrefWeight);for(var variableSize=fixedPixels=0,_a=0;_a<rect.length;_a++)child=rect[_a],prefSize=child._getPrefSize(this.getOrientation()),child._isFixed()?void 0!==prefSize&&child._setTempSize(prefSize):null==prefSize||_i?(0===totalWeight?child._setTempSize(0):(totalPrefWeight=child.getMinSize(this.getOrientation()),
prefSize=Math.floor(prefPixels*(child.getWeight()/totalWeight)),child._setTempSize(Math.max(totalPrefWeight,prefSize))),variableSize+=child._getTempSize()):child._setTempSize(prefSize),fixedPixels+=child._getTempSize();if(0<variableSize){for(;fixedPixels<pixelSize;)for(totalWeight=0,prefPixels=rect;totalWeight<prefPixels.length;totalWeight++)child=prefPixels[totalWeight],child instanceof SplitterNode_1.default||(prefSize=child._getPrefSize(this.getOrientation()),!child._isFixed()&&(void 0===prefSize||
_i)&&fixedPixels<pixelSize&&(child._setTempSize(child._getTempSize()+1),fixedPixels++));for(;fixedPixels>pixelSize;){_i=!1;totalWeight=0;for(prefPixels=rect;totalWeight<prefPixels.length;totalWeight++)child=prefPixels[totalWeight],child instanceof SplitterNode_1.default||(totalPrefWeight=child.getMinSize(this.getOrientation()),prefSize=child._getTempSize(),prefSize>totalPrefWeight&&fixedPixels>pixelSize&&(child._setTempSize(child._getTempSize()-1),fixedPixels--,_i=!0));if(!_i)break}for(;fixedPixels>
pixelSize;){_i=!1;totalWeight=0;for(prefPixels=rect;totalWeight<prefPixels.length;totalWeight++)child=prefPixels[totalWeight],child instanceof SplitterNode_1.default||(prefSize=child._getTempSize(),0<prefSize&&fixedPixels>pixelSize&&(child._setTempSize(child._getTempSize()-1),fixedPixels--,_i=!0));if(!_i)break}}for(fixedPixels=pixelSize=0;fixedPixels<rect.length;fixedPixels++)child=rect[fixedPixels],this.getOrientation()===Orientation_1.default.HORZ?child._layout(new Rect_1.default(this._rect.x+pixelSize,
this._rect.y,child._getTempSize(),this._rect.height),metrics):child._layout(new Rect_1.default(this._rect.x,this._rect.y+pixelSize,this._rect.width,child._getTempSize()),metrics),pixelSize+=child._getTempSize();return!0};RowNode.prototype._getSplitterBounds=function(splitterNode,useMinSize){void 0===useMinSize&&(useMinSize=!1);var pBounds=[0,0],drawChildren=this._getDrawChildren(),p=drawChildren.indexOf(splitterNode),node1=drawChildren[p-1];drawChildren=drawChildren[p+1];this.getOrientation()===Orientation_1.default.HORZ?
(p=useMinSize?node1.getMinWidth():0,useMinSize=useMinSize?drawChildren.getMinWidth():0,pBounds[0]=node1.getRect().x+p,pBounds[1]=drawChildren.getRect().getRight()-splitterNode.getWidth()-useMinSize):(p=useMinSize?node1.getMinHeight():0,useMinSize=useMinSize?drawChildren.getMinHeight():0,pBounds[0]=node1.getRect().y+p,pBounds[1]=drawChildren.getRect().getBottom()-splitterNode.getHeight()-useMinSize);return pBounds};RowNode.prototype._calculateSplit=function(splitter,splitterPos){var drawChildren=this._getDrawChildren(),
p=drawChildren.indexOf(splitter),pBounds=this._getSplitterBounds(splitter),weightedLength=drawChildren[p-1].getWeight()+drawChildren[p+1].getWeight();splitter=Math.max(0,splitterPos-pBounds[0]);splitterPos=Math.max(0,pBounds[1]-splitterPos);if(0<splitter+splitterPos){var rtn=splitter*weightedLength/(splitter+splitterPos);weightedLength=splitterPos*weightedLength/(splitter+splitterPos);rtn={node1Id:drawChildren[p-1].getId(),weight1:rtn,pixelWidth1:splitter,node2Id:drawChildren[p+1].getId(),weight2:weightedLength,
pixelWidth2:splitterPos}}return rtn};RowNode.prototype._getDrawChildren=function(){if(this._dirty){this._drawChildren=[];for(var i=0;i<this._children.length;i++){var child=this._children[i];if(0!==i){var newSplitter=new SplitterNode_1.default(this._model);newSplitter._setParent(this);this._drawChildren.push(newSplitter)}this._drawChildren.push(child)}this._dirty=!1}return this._drawChildren};RowNode.prototype.getMinSize=function(orientation){return orientation===Orientation_1.default.HORZ?this.getMinWidth():
this.getMinHeight()};RowNode.prototype.getMinWidth=function(){return this.minWidth};RowNode.prototype.getMinHeight=function(){return this.minHeight};RowNode.prototype.calcMinSize=function(){var _this=this;this.minWidth=this.minHeight=0;var first=!0;this._children.forEach(function(child){child instanceof RowNode&&child.calcMinSize();_this.getOrientation()===Orientation_1.default.VERT?(_this.minHeight+=child.getMinHeight(),first||(_this.minHeight+=_this._model.getSplitterSize()),_this.minWidth=Math.max(_this.minWidth,
child.getMinWidth())):(_this.minWidth+=child.getMinWidth(),first||(_this.minWidth+=_this._model.getSplitterSize()),_this.minHeight=Math.max(_this.minHeight,child.getMinHeight()));first=!1})};RowNode.prototype._tidy=function(){for(var i=0;i<this._children.length;){var child=this._children[i];if(child instanceof RowNode){child._tidy();var childChildren=child.getChildren();if(0===childChildren.length)this._removeChild(child);else if(1===childChildren.length){var subchild=childChildren[0];this._removeChild(child);
if(subchild instanceof RowNode){childChildren=0;subchild=subchild.getChildren();for(var _i=0,subChildChildren_1=subchild;_i<subChildChildren_1.length;_i++){var subsubChild=subChildChildren_1[_i];childChildren+=subsubChild.getWeight()}for(_i=0;_i<subchild.length;_i++)subsubChild=subchild[_i],subsubChild._setWeight(child.getWeight()*subsubChild.getWeight()/childChildren),this._addChild(subsubChild,i+_i)}else subchild._setWeight(child.getWeight()),this._addChild(subchild,i)}else i++}else child instanceof
TabSetNode_1.default&&0===child.getChildren().length?child.isEnableDeleteWhenEmpty()?(this._removeChild(child),child===this._model.getMaximizedTabset()&&this._model._setMaximizedTabset(void 0)):i++:i++}this===this._model.getRoot()&&0===this._children.length&&(child=new TabSetNode_1.default(this._model,{type:"tabset"}),this._model._setActiveTabset(child),this._addChild(child))};RowNode.prototype.canDrop=function(dragNode,x,y){var yy=y-this._rect.y,xx=x-this._rect.x,w=this._rect.width,h=this._rect.height;
if(this._model.isEnableEdgeDock()&&void 0===this._parent){if(x<this._rect.x+10&&yy>h/2-50&&yy<h/2+50){x=DockLocation_1.default.LEFT;y=x.getDockRect(this._rect);y.width/=2;var dropInfo=new DropInfo_1.default(this,y,x,-1,"flexlayout__outline_rect_edge")}else x>this._rect.getRight()-10&&yy>h/2-50&&yy<h/2+50?(x=DockLocation_1.default.RIGHT,y=x.getDockRect(this._rect),y.width/=2,y.x+=y.width,dropInfo=new DropInfo_1.default(this,y,x,-1,"flexlayout__outline_rect_edge")):y<this._rect.y+10&&xx>w/2-50&&xx<
w/2+50?(x=DockLocation_1.default.TOP,y=x.getDockRect(this._rect),y.height/=2,dropInfo=new DropInfo_1.default(this,y,x,-1,"flexlayout__outline_rect_edge")):y>this._rect.getBottom()-10&&xx>w/2-50&&xx<w/2+50&&(x=DockLocation_1.default.BOTTOM,y=x.getDockRect(this._rect),y.height/=2,y.y+=y.height,dropInfo=new DropInfo_1.default(this,y,x,-1,"flexlayout__outline_rect_edge"));if(void 0!==dropInfo&&!dragNode._canDockInto(dragNode,dropInfo))return}return dropInfo};RowNode.prototype.drop=function(dragNode,location,
index){(index=dragNode.getParent())&&index._removeChild(dragNode);void 0!==index&&index.getType()===TabSetNode_1.default.TYPE&&index._setSelected(0);void 0!==index&&index.getType()===BorderNode_1.default.TYPE&&index._setSelected(-1);dragNode instanceof TabSetNode_1.default?index=dragNode:(index=new TabSetNode_1.default(this._model,{}),index._addChild(dragNode));dragNode=this._children.reduce(function(sum,child){return sum+child.getWeight()},0);0===dragNode&&(dragNode=100);index._setWeight(dragNode/
3);if(location===DockLocation_1.default.LEFT)this._addChild(index,0);else if(location===DockLocation_1.default.RIGHT)this._addChild(index);else if(location===DockLocation_1.default.TOP){location=new RowNode(this._model,{});var hrow_1=new RowNode(this._model,{});hrow_1._setWeight(75);index._setWeight(25);this._children.forEach(function(child){hrow_1._addChild(child)});this._removeAll();location._addChild(index);location._addChild(hrow_1);this._addChild(location)}else if(location===DockLocation_1.default.BOTTOM){location=
new RowNode(this._model,{});var hrow_2=new RowNode(this._model,{});hrow_2._setWeight(75);index._setWeight(25);this._children.forEach(function(child){hrow_2._addChild(child)});this._removeAll();location._addChild(hrow_2);location._addChild(index);this._addChild(location)}this._model._setActiveTabset(index);this._model._tidy()};RowNode.prototype._toJson=function(){var json={};RowNode._attributeDefinitions.toJson(json,this._attributes);json.children=[];this._children.forEach(function(child){json.children.push(child._toJson())});
return json};RowNode.prototype.isEnableDrop=function(){return!0};RowNode.prototype._getPrefSize=function(orientation){var prefSize=this.getWidth();orientation===Orientation_1.default.VERT&&(prefSize=this.getHeight());return prefSize};RowNode.prototype._getAttributeDefinitions=function(){return RowNode._attributeDefinitions};RowNode.prototype._updateAttrs=function(json){RowNode._attributeDefinitions.update(json,this._attributes)};RowNode.TYPE="row";RowNode._attributeDefinitions=RowNode._createAttributeDefinitions();
return RowNode}(global.default);exports.default=require}
//# sourceMappingURL=module$node_modules$flexlayout_react$lib$model$RowNode.js.map
